data.frame()
pairwise_corr
rownames(pairwise_corr)
pairwise_corr["Temperature..C.", "Temperature..C."]
knitr::opts_chunk$set(echo = TRUE)
options(contrasts = c("contr.sum", "contr.poly"))
require("ggplot2")
require("dplyr")
require("ppcor")
weatherHistory <- read.csv("weatherHistory.csv")
select_wH <- weatherHistory %>% select(Temperature..C., Apparent.Temperature..C., Humidity)
pairwise_corr <- select_wH %>%
cor() %>%
data.frame()
pairwise_corr
rownames(pairwise_corr)
pairwise_corr["Temperature..C.", "Temperature..C."]
pairwise_corr <- select_wH %>%
cor() %>%
data.frame()
pairwise_corr
#partial_corr <- funcion(X, Y, Z, corrMat) {
#  p_XY <- corrMat[X, Y]
#}
part_corr <- select_wH %>%
pcor() %>%
data.frame()
part_corr
#partial_corr <- funcion(X, Y, Z, corrMat) {
#  p_XY <- corrMat[X, Y]
#}
part_corr <- select_wH %>%
pcor()
part_corr
pairwise_corr <- select_wH %>%
cor()
pairwise_corr
pairwise_corr <- select_wH %>%
cor() %>%
data.frame()
pairwise_corr
#partial_corr <- funcion(X, Y, Z, corrMat) {
#  p_XY <- corrMat[X, Y]
#}
part_corr <- select_wH %>%
pcor()
part_corr
require("ggplot2")
require("dplyr")
require("ppcor")
require("caret")
require("tidyr")
knitr::opts_chunk$set(echo = TRUE)
options(contrasts = c("contr.sum", "contr.poly"))
require("ggplot2")
require("dplyr")
require("ppcor")
require("caret")
require("tidyr")
gapminder <- read.csv("gapminder.csv")
summary(gapminder)
gapminder %>%
ggplot(aes(x=year, y=lifeExp, colour=continent)) +
#geom_bar(position='dodge', stat='identity')
geom_line()
gapminder %>%
ggplot(aes(x=year, y=lifeExp, colour=continent)) +
#geom_bar(position='dodge', stat='identity')
geom_line()
gapminder %>%
ggplot(aes(x=year, y=lifeExp, colour=continent)) +
#geom_bar(position='dodge', stat='identity')
geom_line()
knitr::kable(
gapminder %>%
group_by(continent, year) %>%
summarise_at(vars(lifeExp), list(Min = min, Med = median, Mean = mean, Max = max, Sd = sd)) %>%
data.frame()
)
gapminder %>%
group_by(continent, year) %>%
summarise(Mean_lifeExp= mean(lifeExp, na.rm = T), .groups = 'drop') %>%
ggplot(aes(x=year, y=Mean_lifeExp)) +
geom_ribbon(aes(ymin= Mean_lifeExp - 1, ymax = Mean_lifeExp + 1), fill = "grey70") +
geom_line() +
facet_grid(.~continent) +
theme(axis.text.x = element_text(angle=90)) +
ylim(0, NA)
weatherHistory <- read.csv("weatherHistory.csv")
head(weatherHistory)
weatherHistory %>%
group_by(Precip.Type) %>%
summarize(Count = n()) %>%
ggplot(aes(x=Precip.Type, y=Count)) +
geom_bar(stat='identity', position='dodge')
weatherHistory %>%
group_by(Summary) %>%
summarize(Count = n()) %>%
ggplot(aes(x=Summary, y=Count)) +
geom_bar(stat='identity', position='dodge') +
theme(axis.text.x = element_text(angle=90))
weatherHistory %>%
group_by(Daily.Summary) %>%
summarize(Count = n()) %>%
ggplot(aes(x=Daily.Summary, y=Count)) +
geom_bar(stat='identity', position='dodge')
weatherHistory %>%
ggplot(aes(Temperature..C.)) +
geom_histogram(aes(y = ..density..), fill = "white", color="black") +
stat_density(kernel = "gaussian", fill = NA, colour = "black")
weatherHistory %>%
ggplot(aes(Apparent.Temperature..C.)) +
geom_histogram(aes(y = ..density..), fill = "white", color="black") +
stat_density(kernel = "gaussian", fill = NA, colour = "black")
weatherHistory %>%
ggplot(aes(Humidity)) +
geom_histogram(aes(y = ..density..), fill = "white", color="black") +
stat_density(kernel = "gaussian", fill = NA, colour = "black")
weatherHistory %>%
ggplot(aes(Wind.Speed..km.h.)) +
geom_histogram(aes(y = ..density..), fill = "white", color="black") +
stat_density(kernel = "gaussian", fill = NA, colour = "black")
weatherHistory %>%
ggplot(aes(Visibility..km.)) +
geom_histogram(aes(y = ..density..), fill = "white", color="black") +
stat_density(kernel = "gaussian", fill = NA, colour = "black")
# weatherHistory %>%
#   group_by(Wind.Bearing..degrees.) %>%
#   summarize(Count = n()) %>%
#   ggplot(aes(x=Wind.Bearing..degrees., y=Count)) +
#   geom_bar(stat='identity', position='dodge') +
#   theme(axis.text.x = element_text(angle=90))
weatherHistory %>%
ggplot(aes(Wind.Bearing..degrees.)) +
geom_histogram(aes(y = ..density..), fill = "white", color="black") +
stat_density(kernel = "gaussian", fill = NA, colour = "black")
weatherHistory %>%
group_by(Loud.Cover) %>%
summarize(Count = n()) %>%
ggplot(aes(x=Loud.Cover, y=Count)) +
geom_bar(stat='identity', position='dodge') +
theme(axis.text.x = element_text(angle=90))
weatherHistory <- weatherHistory %>% select(-c("Formatted.Date", "Daily.Summary", "Loud.Cover"))
weatherHistory <- weatherHistory %>% select(-c("Formatted.Date", "Daily.Summary", "Loud.Cover"))
drop_weatherHistory <- weatherHistory %>% select(-c("Formatted.Date", "Daily.Summary", "Loud.Cover"))
knitr::opts_chunk$set(echo = TRUE)
options(contrasts = c("contr.sum", "contr.poly"))
require("ggplot2")
require("dplyr")
require("ppcor")
require("caret")
require("tidyr")
gapminder <- read.csv("gapminder.csv")
summary(gapminder)
gapminder %>%
ggplot(aes(x=year, y=lifeExp, colour=continent)) +
#geom_bar(position='dodge', stat='identity')
geom_line()
knitr::kable(
gapminder %>%
group_by(continent, year) %>%
summarise_at(vars(lifeExp), list(Min = min, Med = median, Mean = mean, Max = max, Sd = sd)) %>%
data.frame()
)
gapminder %>%
group_by(continent, year) %>%
summarise(Mean_lifeExp= mean(lifeExp, na.rm = T), .groups = 'drop') %>%
ggplot(aes(x=year, y=Mean_lifeExp)) +
geom_ribbon(aes(ymin= Mean_lifeExp - 1, ymax = Mean_lifeExp + 1), fill = "grey70") +
geom_line() +
facet_grid(.~continent) +
theme(axis.text.x = element_text(angle=90)) +
ylim(0, NA)
weatherHistory <- read.csv("weatherHistory.csv")
head(weatherHistory)
weatherHistory %>%
group_by(Precip.Type) %>%
summarize(Count = n()) %>%
ggplot(aes(x=Precip.Type, y=Count)) +
geom_bar(stat='identity', position='dodge')
weatherHistory %>%
group_by(Summary) %>%
summarize(Count = n()) %>%
ggplot(aes(x=Summary, y=Count)) +
geom_bar(stat='identity', position='dodge') +
theme(axis.text.x = element_text(angle=90))
weatherHistory %>%
group_by(Daily.Summary) %>%
summarize(Count = n()) %>%
ggplot(aes(x=Daily.Summary, y=Count)) +
geom_bar(stat='identity', position='dodge')
weatherHistory %>%
ggplot(aes(Temperature..C.)) +
geom_histogram(aes(y = ..density..), fill = "white", color="black") +
stat_density(kernel = "gaussian", fill = NA, colour = "black")
weatherHistory %>%
ggplot(aes(Apparent.Temperature..C.)) +
geom_histogram(aes(y = ..density..), fill = "white", color="black") +
stat_density(kernel = "gaussian", fill = NA, colour = "black")
weatherHistory %>%
ggplot(aes(Humidity)) +
geom_histogram(aes(y = ..density..), fill = "white", color="black") +
stat_density(kernel = "gaussian", fill = NA, colour = "black")
weatherHistory %>%
ggplot(aes(Wind.Speed..km.h.)) +
geom_histogram(aes(y = ..density..), fill = "white", color="black") +
stat_density(kernel = "gaussian", fill = NA, colour = "black")
weatherHistory %>%
ggplot(aes(Visibility..km.)) +
geom_histogram(aes(y = ..density..), fill = "white", color="black") +
stat_density(kernel = "gaussian", fill = NA, colour = "black")
# weatherHistory %>%
#   group_by(Wind.Bearing..degrees.) %>%
#   summarize(Count = n()) %>%
#   ggplot(aes(x=Wind.Bearing..degrees., y=Count)) +
#   geom_bar(stat='identity', position='dodge') +
#   theme(axis.text.x = element_text(angle=90))
weatherHistory %>%
ggplot(aes(Wind.Bearing..degrees.)) +
geom_histogram(aes(y = ..density..), fill = "white", color="black") +
stat_density(kernel = "gaussian", fill = NA, colour = "black")
weatherHistory %>%
group_by(Loud.Cover) %>%
summarize(Count = n()) %>%
ggplot(aes(x=Loud.Cover, y=Count)) +
geom_bar(stat='identity', position='dodge') +
theme(axis.text.x = element_text(angle=90))
drop_weatherHistory <- weatherHistory %>% select(-c("Formatted.Date", "Daily.Summary", "Loud.Cover"))
weatherHistory
weatherHistory
drop_weatherHistory <- weatherHistory %>% select(-c("Formatted.Date", "Daily.Summary", "Loud.Cover"), .)
weatherHistory
drop_weatherHistory <- weatherHistory %>% select(-c("Formatted.Date", "Daily.Summary", "Loud.Cover"))
weatherHistory
drop_weatherHistory <- weatherHistory %>% dplyr::select(-c("Formatted.Date", "Daily.Summary", "Loud.Cover"))
drop_weatherHistory <- na.omit(drop_weatherHistory) # Remove all NA
head(drop_weatherHistory)
knitr::opts_chunk$set(echo = TRUE)
options(contrasts = c("contr.sum", "contr.poly"))
require("ggplot2")
require("dplyr")
require("ppcor")
require("caret")
require("tidyr")
gapminder <- read.csv("gapminder.csv")
summary(gapminder)
gapminder %>%
ggplot(aes(x=year, y=lifeExp, colour=continent)) +
#geom_bar(position='dodge', stat='identity')
geom_line()
knitr::kable(
gapminder %>%
group_by(continent, year) %>%
summarise_at(vars(lifeExp), list(Min = min, Med = median, Mean = mean, Max = max, Sd = sd)) %>%
data.frame()
)
gapminder %>%
group_by(continent, year) %>%
summarise(Mean_lifeExp= mean(lifeExp, na.rm = T), .groups = 'drop') %>%
ggplot(aes(x=year, y=Mean_lifeExp)) +
geom_ribbon(aes(ymin= Mean_lifeExp - 1, ymax = Mean_lifeExp + 1), fill = "grey70") +
geom_line() +
facet_grid(.~continent) +
theme(axis.text.x = element_text(angle=90)) +
ylim(0, NA)
weatherHistory <- read.csv("weatherHistory.csv")
head(weatherHistory)
weatherHistory %>%
group_by(Precip.Type) %>%
summarize(Count = n()) %>%
ggplot(aes(x=Precip.Type, y=Count)) +
geom_bar(stat='identity', position='dodge')
weatherHistory %>%
group_by(Summary) %>%
summarize(Count = n()) %>%
ggplot(aes(x=Summary, y=Count)) +
geom_bar(stat='identity', position='dodge') +
theme(axis.text.x = element_text(angle=90))
weatherHistory %>%
group_by(Daily.Summary) %>%
summarize(Count = n()) %>%
ggplot(aes(x=Daily.Summary, y=Count)) +
geom_bar(stat='identity', position='dodge')
weatherHistory %>%
ggplot(aes(Temperature..C.)) +
geom_histogram(aes(y = ..density..), fill = "white", color="black") +
stat_density(kernel = "gaussian", fill = NA, colour = "black")
weatherHistory %>%
ggplot(aes(Apparent.Temperature..C.)) +
geom_histogram(aes(y = ..density..), fill = "white", color="black") +
stat_density(kernel = "gaussian", fill = NA, colour = "black")
weatherHistory %>%
ggplot(aes(Humidity)) +
geom_histogram(aes(y = ..density..), fill = "white", color="black") +
stat_density(kernel = "gaussian", fill = NA, colour = "black")
weatherHistory %>%
ggplot(aes(Wind.Speed..km.h.)) +
geom_histogram(aes(y = ..density..), fill = "white", color="black") +
stat_density(kernel = "gaussian", fill = NA, colour = "black")
weatherHistory %>%
ggplot(aes(Visibility..km.)) +
geom_histogram(aes(y = ..density..), fill = "white", color="black") +
stat_density(kernel = "gaussian", fill = NA, colour = "black")
# weatherHistory %>%
#   group_by(Wind.Bearing..degrees.) %>%
#   summarize(Count = n()) %>%
#   ggplot(aes(x=Wind.Bearing..degrees., y=Count)) +
#   geom_bar(stat='identity', position='dodge') +
#   theme(axis.text.x = element_text(angle=90))
weatherHistory %>%
ggplot(aes(Wind.Bearing..degrees.)) +
geom_histogram(aes(y = ..density..), fill = "white", color="black") +
stat_density(kernel = "gaussian", fill = NA, colour = "black")
weatherHistory %>%
group_by(Loud.Cover) %>%
summarize(Count = n()) %>%
ggplot(aes(x=Loud.Cover, y=Count)) +
geom_bar(stat='identity', position='dodge') +
theme(axis.text.x = element_text(angle=90))
weatherHistory
drop_weatherHistory <- weatherHistory %>% dplyr::select(-c("Formatted.Date", "Daily.Summary", "Loud.Cover"))
drop_weatherHistory <- na.omit(drop_weatherHistory) # Remove all NA
head(drop_weatherHistory)
num_wH <- drop_weatherHistory %>%
dplyr::select(-c("Summary", "Precip.Type"))
num_stand_wH <- as.data.frame(sapply(num_wH, function(x) ((x-mean(x))/sd(x))))
qualitative_wH <- drop_weatherHistory %>%
dplyr::select(c("Summary", "Precip.Type")) #Omitted "Formatted.Date","Daily.Summary"
# PT <- factor(qualitative_wH$Precip.Type)
# PT <- as.data.frame(model.matrix(~ Precip.Type - 1, PT))
#
# FD <- factor(qualitative_wH$Summary)
# FD <- as.data.frame(model.matrix(~ f - Summary - 1, FD))
q1 <- table(1:nrow(drop_weatherHistory), drop_weatherHistory$Precip.Type) # as.data.frame.matrix(
q2 <- table(1:nrow(drop_weatherHistory), drop_weatherHistory$Summary)
q <- as.data.frame.matrix(cbind(q1, q2))
#head(merge(PT, FD))
#oh_drop_weatherHistory <- dummyVars("~ .", data = qualitative_wH)
#oh_drop_weatherHistory <- data.frame(predict(oh_drop_weatherHistory, newdata = qualitative_wH))
#head(num_stand_wH)
cleaned_wH <- cbind(num_stand_wH, q)
head(cleaned_wH)
sample <- sample(c(T, F), nrow(cleaned_wH), replace=T, prob=c(0.75, 0.25))
test_wH <- cleaned_wH[!sample,]
train_wH <- cleaned_wH[sample,]
wH_lm <- train_wH %>%
lm(Apparent.Temperature..C. ~ rain + snow + Pressure..millibars. + Humidity + Temperature..C. + Wind.Speed..km.h., .)
summary.aov(wH_lm)
summary(wH_lm)
y_test_true <- test_wH$Apparent.Temperature..C.
y_test_pred <- predict(wH_lm, newdata = test_wH)
y_train_true <- train_wH$Apparent.Temperature..C.
y_train_pred <- predict(wH_lm, newdata = train_wH)
rmse_test <- RMSE(y_test_pred, y_test_true)
rmse_train <- RMSE(y_train_pred, y_train_true)
rmse_test
rmse_test
mae_test <- MAE(y_test_pred, y_test_true)
mae_train <- MAE(y_train_pred, y_train_true)
mae_test
mae_train
R2_test <- R2(y_test_pred, y_test_true)
R2_train <- R2(y_train_pred, y_train_true)
R2_test
R2_train
plot(wH_lm,1)
plot(wH_lm,2)
plot(wH_lm,3)
plot(wH_lm,5)
data_gen <- function(c=0, t=0, cm=0, cp=100, cs=0, nnm=1, nnp=10000, snn=500, nnnm=0, nnnp=10000, snnn=500) {
set.seed(42)
n <- 1000
x <- 1:n
# Changeable parameters
# - Change the parameters to affect the generated data points below.
# - You may copy this code multiple times to answer all the questions in the exercise.
# - You may find it reasonable to argue for multiple violations from a single generated set of data points.
contant <- c
trend <- t
curve_magnitue <- cm
curve_period <- cp
curve_shift <- cs
normal_noise_magnitue <- nnm
norm_noise_periode <- nnp
shift_norm_noise <- snn
non_normal_noise_magnitue <- nnnm
non_norm_noice_periode <- nnnp
shift_non_norm_noise <- snnn
y.gen <- contant +
trend * x +
curve_magnitue* sin(
(x/curve_period + curve_shift)*pi
) +
normal_noise_magnitue*cos(
(x/norm_noise_periode + shift_norm_noise/norm_noise_periode)*pi
)*rnorm(n, sd = 3) +
non_normal_noise_magnitue*cos(
(x/non_norm_noice_periode + shift_non_norm_noise/non_norm_noice_periode)*pi
) * rexp(n, rate = 0.2)
p <- qplot(x, y.gen, ylab = "y") +
geom_point(size = 0.1) +
labs(title = "Data generate for linear regrestion")
# Display the plot
print(p)
return(list("x"=x,"y.gen"=y.gen))
}
gen_data <- data_gen()
lm.gen <- lm(gen_data$y.gen ~ gen_data$x)
plot(lm.gen, which = 1)
plot(lm.gen, which = 2)
plot(lm.gen, which = 3)
plot(lm.gen, which = 5)
gen_data <- data_gen(nnnm = -10000, snnn = 5000, nnnp = 50000)
lm.gen <- lm(gen_data$y.gen ~ gen_data$x)
plot(lm.gen, which = 2)
gen_data <- data_gen(nnnm = -10000, snnn = 5000, cs=10000, cm = 10000, snn = 10000)
lm.gen <- lm(gen_data$y.gen ~ (gen_data$x)^4)
plot(lm.gen, 1)
gen_data <- data_gen(nnnm = 10000, snnn = 5000, cs=10000, cm = 10000, snn = 10000, nnm = 0, nnnp = 5000, t = 1)
lm.gen <- lm(gen_data$y.gen ~ gen_data$x)
plot(lm.gen, 2)
weatherHistory <- read.csv("weatherHistory.csv")
select_wH <- weatherHistory %>% dplyr::select(Temperature..C., Apparent.Temperature..C., Humidity)
pairwise_corr <- select_wH %>%
cor() %>%
data.frame()
pairwise_corr
gapminder %>%
group_by(continent) %>%
ggplot(aes(x=year, y=lifeExp, colour=continent)) +
#geom_bar(position='dodge', stat='identity')
geom_line()
gapminder %>%
group_by(country) %>%
ggplot(aes(x=year, y=lifeExp, colour=continent)) +
#geom_bar(position='dodge', stat='identity')
geom_line()
gapminder <- read.csv("gapminder.csv")
summary(gapminder)
gapminder %>%
group_by(country) %>%
ggplot(aes(x=year, y=lifeExp, colour=continent)) +
#geom_bar(position='dodge', stat='identity')
geom_line()
gapminder %>%
group_by(country) %>%
ggplot(aes(x=year, y=lifeExp, gorup=country,  colour=continent)) +
#geom_bar(position='dodge', stat='identity')
geom_line()
gapminder %>%
group_by(continent, year) %>%
summarise(Mean_lifeExp= c(mean(lifeExp, na.rm = T), sd(lifeExp, na.rm = T)), .groups = 'drop') %>%
ggplot(aes(x=year, y=Mean_lifeExp[0])) +
geom_ribbon(aes(ymin= Mean_lifeExp[0] - Mean_lifeExp[1], ymax = Mean_lifeExp + Mean_lifeExp[1]), fill = "grey70") +
geom_line() +
facet_grid(.~continent) +
theme(axis.text.x = element_text(angle=90)) +
ylim(0, NA)
gapminder %>%
group_by(continent, year) %>%
summarise(Mean_lifeExp= c(mean(lifeExp, na.rm = T), sd(lifeExp, na.rm = T)), .groups = 'drop') %>%
ggplot(aes(x=year, y=Mean_lifeExp[1])) +
geom_ribbon(aes(ymin= Mean_lifeExp[1] - Mean_lifeExp[2], ymax = Mean_lifeExp[1] + Mean_lifeExp[2]), fill = "grey70") +
geom_line() +
facet_grid(.~continent) +
theme(axis.text.x = element_text(angle=90)) +
ylim(0, NA)
gapminder %>%
group_by(continent, year) %>%
summarise(Mean_lifeExp= c(mean(lifeExp, na.rm = T), sd(lifeExp, na.rm = T))) %>%
ggplot(aes(x=year, y=Mean_lifeExp[1])) +
geom_ribbon(aes(ymin= Mean_lifeExp[1] - Mean_lifeExp[2], ymax = Mean_lifeExp[1] + Mean_lifeExp[2]), fill = "grey70") +
geom_line() +
facet_grid(.~continent) +
theme(axis.text.x = element_text(angle=90)) +
ylim(0, NA)
gapminder %>%
group_by(continent, year) %>%
summarise(Mean_lifeExp=mean(lifeExp, na.rm = T), SD_Mean_lifeExp=sd(lifeExp, na.rm = T)) %>%
ggplot(aes(x=year, y=Mean_lifeExp)) +
geom_ribbon(aes(ymin= Mean_lifeExp - SD_lifeExp, ymax = Mean_lifeExp + SD_lifeExp), fill = "grey70") +
geom_line() +
facet_grid(.~continent) +
theme(axis.text.x = element_text(angle=90)) +
ylim(0, NA)
gapminder %>%
group_by(continent, year) %>%
summarise(Mean_lifeExp=mean(lifeExp, na.rm = T), SD_lifeExp=sd(lifeExp, na.rm = T)) %>%
ggplot(aes(x=year, y=Mean_lifeExp)) +
geom_ribbon(aes(ymin= Mean_lifeExp - SD_lifeExp, ymax = Mean_lifeExp + SD_lifeExp), fill = "grey70") +
geom_line() +
facet_grid(.~continent) +
theme(axis.text.x = element_text(angle=90)) +
ylim(0, NA)
gapminder %>%
group_by(continent, year) %>%
summarise(Mean_lifeExp=mean(lifeExp, na.rm = T), SD_lifeExp=sd(lifeExp, na.rm = T), .groups = continent) %>%
ggplot(aes(x=year, y=Mean_lifeExp)) +
geom_ribbon(aes(ymin= Mean_lifeExp - SD_lifeExp, ymax = Mean_lifeExp + SD_lifeExp), fill = "grey70") +
geom_line() +
facet_grid(.~continent) +
theme(axis.text.x = element_text(angle=90)) +
ylim(0, NA)
gapminder %>%
group_by(continent, year) %>%
summarise(Mean_lifeExp=mean(lifeExp, na.rm = T), SD_lifeExp=sd(lifeExp, na.rm = T), .groups = "drop") %>%
ggplot(aes(x=year, y=Mean_lifeExp)) +
geom_ribbon(aes(ymin= Mean_lifeExp - SD_lifeExp, ymax = Mean_lifeExp + SD_lifeExp), fill = "grey70") +
geom_line() +
facet_grid(.~continent) +
theme(axis.text.x = element_text(angle=90)) +
ylim(0, NA)
