---
title: "Assignment 1"
author: 
- Erling Tenn√∏y Nordtvedt 
- Oleg Karpov
date: "2024-09-16"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
#options(contrasts = c("contr.sum", "contr.poly"))
require("ggplot2")
require("dplyr")
```

## Excercise 1 - R syntax & data structures

### (a)
```{r E1_a}
gapminder <- read.csv("gapminder.csv")

summary(gapminder)
```

### (b)
``` {r E1_b}
gapminder %>%
  ggplot(aes(x=year, y=lifeExp, colour=continent)) +
    #geom_bar(position='dodge', stat='identity')
    geom_line()
```

### (c)
```{r E1_c}
knitr::kable(
  gapminder %>%
    group_by(continent, year) %>%
    summarise_at(vars(lifeExp), list(Min = min, Med = median, Mean = mean, Max = max, Sd = sd)) %>%
    data.frame()
)
```

### (d)
```{r E1_d}
gapminder %>%
  group_by(continent, year) %>%
  summarise(Mean_lifeExp= mean(lifeExp, na.rm = T), .groups = 'drop') %>%
  ggplot(aes(x=year, y=Mean_lifeExp)) +
  geom_ribbon(aes(ymin= Mean_lifeExp - 1, ymax = Mean_lifeExp + 1), fill = "grey70") +
  geom_line() +
  facet_grid(.~continent) +
  theme(axis.text.x = element_text(angle=90)) +
  ylim(0, NA)
```

## Excercise 2 - Elementary data analysis and model training

### (a)
```{r E2_a_1}
weatherHistory <- read.csv("weatherHistory.csv")
head(weatherHistory)
```
**Qualitative nominal**

* Summary
* Precip.Type
* Daily.Summary

**Quantitative Continuous:**

* Temperature..C.
* Apparent.Temperature..C.
* Humidity
* Wind.Speed..km.h.
* Visibility..km.
* Wind.Bearing..degrees (Reason: Not ranked)

**Quantitative Discrete:**

* Formatted.Date
* Loud.Cover

#### Qualitative nominal
``` {r E2_a_2}
weatherHistory %>%
  group_by(Precip.Type) %>%
  summarize(Count = n()) %>%
  ggplot(aes(x=Precip.Type, y=Count)) +
  geom_bar(stat='identity', position='dodge')
```


``` {r E2_a_3}
weatherHistory %>%
  group_by(Summary) %>%
  summarize(Count = n()) %>%
  ggplot(aes(x=Summary, y=Count)) +
  geom_bar(stat='identity', position='dodge') +
  theme(axis.text.x = element_text(angle=90))
```
``` {r E2_a_4}
weatherHistory %>%
  group_by(Daily.Summary) %>%
  summarize(Count = n()) %>%
  ggplot(aes(x=Daily.Summary, y=Count)) +
  geom_bar(stat='identity', position='dodge')
```


#### Discrete nominal
```{r E2_a_5}
weatherHistory %>%
  ggplot(aes(Temperature..C.)) +
  geom_histogram(aes(y = ..density..), fill = "white", color="black") +
  stat_density(kernel = "gaussian", fill = NA, colour = "black")
```


```{r E2_a_6}
weatherHistory %>%
  ggplot(aes(Apparent.Temperature..C.)) +
  geom_histogram(aes(y = ..density..), fill = "white", color="black") +
  stat_density(kernel = "gaussian", fill = NA, colour = "black")
```


```{r E2_a_7}
weatherHistory %>%
  ggplot(aes(Humidity)) +
  geom_histogram(aes(y = ..density..), fill = "white", color="black") +
  stat_density(kernel = "gaussian", fill = NA, colour = "black")
```
```{r E2_a_8}
weatherHistory %>%
  ggplot(aes(Wind.Speed..km.h.)) +
  geom_histogram(aes(y = ..density..), fill = "white", color="black") +
  stat_density(kernel = "gaussian", fill = NA, colour = "black")
```
```{r E2_a_9}
weatherHistory %>%
  ggplot(aes(Visibility..km.)) +
  geom_histogram(aes(y = ..density..), fill = "white", color="black") +
  stat_density(kernel = "gaussian", fill = NA, colour = "black")
```

``` {r E2_a_11}

# weatherHistory %>%
#   group_by(Wind.Bearing..degrees.) %>%
#   summarize(Count = n()) %>%
#   ggplot(aes(x=Wind.Bearing..degrees., y=Count)) +
#   geom_bar(stat='identity', position='dodge') +
#   theme(axis.text.x = element_text(angle=90))

weatherHistory %>%
  ggplot(aes(Wind.Bearing..degrees.)) +
  geom_histogram(aes(y = ..density..), fill = "white", color="black") +
  stat_density(kernel = "gaussian", fill = NA, colour = "black")
```

#### Quantative discrete
```{r E2_a_10}
weatherHistory %>%
  group_by(Loud.Cover) %>%
  summarize(Count = n()) %>%
  ggplot(aes(x=Loud.Cover, y=Count)) +
  geom_bar(stat='identity', position='dodge') +
  theme(axis.text.x = element_text(angle=90))
```

### (b)
First removing all columns that seem irrelevant, reasoning:

* Formatted.Date : When encoded it will be equal to row label (1, 2, 3, ...) which tells nothing
* Loud.Cover : All values are 0, therfore tells nothing
* Daily.Summary : Too big to onehotencode effectivly

Then remove all rows with NA, do this after removing irrelevant columns so data is not lost to having NA in the removed columns
```{r E2_b_1}
library(caret)
library(tidyr)
library(dplyr)
weatherHistory <- weatherHistory %>% select(-c("Formatted.Date", "Daily.Summary", "Loud.Cover"))
weatherHistory <- na.omit(weatherHistory) # Remove all NA
head(weatherHistory)
```

``` {r E2_b_2}

num_wH <- weatherHistory %>%
  select(-c("Summary", "Precip.Type")) 
num_stand_wH <- as.data.frame(sapply(num_wH, function(x) ((x-mean(x))/sd(x))))

qualitative_wH <- weatherHistory %>%
  select(c("Summary", "Precip.Type")) #Omitted "Formatted.Date","Daily.Summary"

# PT <- factor(qualitative_wH$Precip.Type)
# PT <- as.data.frame(model.matrix(~ Precip.Type - 1, PT))
# 
# FD <- factor(qualitative_wH$Summary)
# FD <- as.data.frame(model.matrix(~ f - Summary - 1, FD))


#head(merge(PT, FD))

#oh_weatherHistory <- dummyVars("~ .", data = qualitative_wH)
#oh_weatherHistory <- data.frame(predict(oh_weatherHistory, newdata = qualitative_wH))
#head(num_stand_wH)
head(oh_weatherHistory)
```